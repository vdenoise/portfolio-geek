{
  "hash": "f947f0a3515978f54eeadde2adbd4080",
  "result": {
    "markdown": "---\ntitle: Analyzing Equity long Term Returns with Python\ncategories: [tutorial, 101, en]\nformat:\n    html: default \n--- \n\n![](/pictures/time-horizon-paper.png)\n\n# Analyzing long Term Returns with Python: \n\n## Introduction\n\nIn this article, we will explore how to download Shiller's Excel data on long-term stock market returns from his website using Python. We will use the requests library for HTTP requests and the pandas library for data manipulation. For visualization, we will use the Matplotlib library with the Pacoty stylesheet to create a chart comparing nominal equity returns, real equity returns, and real GDP growth.\n\nDownloading Shiller's Data\n\nFirst, we need to import the required libraries and download the data using an HTTP request:\n\nThis code snippet downloads the Excel file from Shiller's website and reads it into a pandas DataFrame.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport requests\nimport pandas as pd\nfrom io import BytesIO\n\nurl = \"http://www.econ.yale.edu/~shiller/data/ie_data.xls\"\n\nresponse = requests.get(url)\n\n# Check if the request was successful\nif response.status_code == 200:\n    data = pd.read_excel(BytesIO(response.content), sheet_name='Data', header=7)\nelse:\n    print(\"Failed to download the data\")\n```\n:::\n\n\n## Visualizing the Data with Matplotlib and Pacoty\n\n\nNext, we will create a chart comparing the nominal equity returns, real equity returns, and real GDP growth using Matplotlib and the Pacoty stylesheet:\npython\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndata\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>P</th>\n      <th>D</th>\n      <th>E</th>\n      <th>CPI</th>\n      <th>Fraction</th>\n      <th>Rate GS10</th>\n      <th>Price</th>\n      <th>Dividend</th>\n      <th>Price.1</th>\n      <th>...</th>\n      <th>CAPE</th>\n      <th>Unnamed: 13</th>\n      <th>TR CAPE</th>\n      <th>Unnamed: 15</th>\n      <th>Yield</th>\n      <th>Returns</th>\n      <th>Returns.1</th>\n      <th>Real Return</th>\n      <th>Real Return.1</th>\n      <th>Returns.2</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1871.01</td>\n      <td>4.44</td>\n      <td>0.26</td>\n      <td>0.4</td>\n      <td>12.464061</td>\n      <td>1871.041667</td>\n      <td>5.32</td>\n      <td>107.612654</td>\n      <td>6.301642</td>\n      <td>1.076127e+02</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.004177</td>\n      <td>1.000000</td>\n      <td>0.130609</td>\n      <td>0.092504</td>\n      <td>0.038106</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1871.02</td>\n      <td>4.5</td>\n      <td>0.26</td>\n      <td>0.4</td>\n      <td>12.844641</td>\n      <td>1871.125000</td>\n      <td>5.323333</td>\n      <td>105.835283</td>\n      <td>6.114927</td>\n      <td>1.063449e+02</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.004180</td>\n      <td>0.974424</td>\n      <td>0.130858</td>\n      <td>0.094635</td>\n      <td>0.036224</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1871.03</td>\n      <td>4.61</td>\n      <td>0.26</td>\n      <td>0.4</td>\n      <td>13.034972</td>\n      <td>1871.208333</td>\n      <td>5.326667</td>\n      <td>106.839235</td>\n      <td>6.025640</td>\n      <td>1.078582e+02</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.004183</td>\n      <td>0.964209</td>\n      <td>0.130951</td>\n      <td>0.096186</td>\n      <td>0.034765</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1871.04</td>\n      <td>4.74</td>\n      <td>0.26</td>\n      <td>0.4</td>\n      <td>12.559226</td>\n      <td>1871.291667</td>\n      <td>5.33</td>\n      <td>114.013268</td>\n      <td>6.253892</td>\n      <td>1.156268e+02</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.004185</td>\n      <td>1.004919</td>\n      <td>0.122056</td>\n      <td>0.090972</td>\n      <td>0.031084</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1871.05</td>\n      <td>4.86</td>\n      <td>0.26</td>\n      <td>0.4</td>\n      <td>12.273812</td>\n      <td>1871.375000</td>\n      <td>5.333333</td>\n      <td>119.618062</td>\n      <td>6.399320</td>\n      <td>1.218517e+02</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1.004188</td>\n      <td>1.032591</td>\n      <td>0.122638</td>\n      <td>0.089488</td>\n      <td>0.033150</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>1824</th>\n      <td>2023.01</td>\n      <td>3960.6565</td>\n      <td>67.35</td>\n      <td>NaN</td>\n      <td>299.17</td>\n      <td>2023.041667</td>\n      <td>3.53</td>\n      <td>3999.346939</td>\n      <td>68.007921</td>\n      <td>2.604715e+06</td>\n      <td>...</td>\n      <td>28.334813</td>\n      <td>NaN</td>\n      <td>30.691634</td>\n      <td>NaN</td>\n      <td>0.026509</td>\n      <td>0.984746</td>\n      <td>41.286210</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1825</th>\n      <td>2023.02</td>\n      <td>4079.684737</td>\n      <td>67.78</td>\n      <td>NaN</td>\n      <td>300.84</td>\n      <td>2023.125000</td>\n      <td>3.75</td>\n      <td>4096.669862</td>\n      <td>68.062191</td>\n      <td>2.671794e+06</td>\n      <td>...</td>\n      <td>28.977514</td>\n      <td>NaN</td>\n      <td>31.409746</td>\n      <td>NaN</td>\n      <td>0.023261</td>\n      <td>1.010600</td>\n      <td>40.430726</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1826</th>\n      <td>2023.03</td>\n      <td>3968.55913</td>\n      <td>68.21</td>\n      <td>NaN</td>\n      <td>301.675</td>\n      <td>2023.208333</td>\n      <td>3.66</td>\n      <td>3974.051377</td>\n      <td>68.304399</td>\n      <td>2.595537e+06</td>\n      <td>...</td>\n      <td>28.063455</td>\n      <td>NaN</td>\n      <td>30.441826</td>\n      <td>NaN</td>\n      <td>0.025301</td>\n      <td>1.022361</td>\n      <td>40.746209</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1827</th>\n      <td>2023.04</td>\n      <td>4100.6</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>302.0925</td>\n      <td>2023.291667</td>\n      <td>3.43</td>\n      <td>4100.600000</td>\n      <td>NaN</td>\n      <td>2.678188e+06</td>\n      <td>...</td>\n      <td>28.908607</td>\n      <td>NaN</td>\n      <td>31.337301</td>\n      <td>NaN</td>\n      <td>0.026808</td>\n      <td>NaN</td>\n      <td>41.599762</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>1828</th>\n      <td>NaN</td>\n      <td>Apr price is Apr 4th close</td>\n      <td>NaN</td>\n      <td>Dec Estimated</td>\n      <td>Mar/Apr CPI estimated</td>\n      <td>NaN</td>\n      <td>Apr GS10 is Apr 4th value</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n  </tbody>\n</table>\n<p>1829 rows Ã— 22 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Set the Pacoty stylesheet\n#plt.style.use('pacoty')\n\n# Create a figure and axis\nfig, ax = plt.subplots()\n\n# Extract the data we need\nyears = data['Date']\nnominal_returns = data['Price.1']\n#real_returns = data['Real S&P Equity Index']\n#gdp_growth = data['Real GDP Growth']\n\n# Plot the data on a logarithmic scale\nax.semilogy(years, nominal_returns, label='Nominal Equity Returns')\n\n# Customize the chart\nax.set_xlabel('Years')\nax.set_ylabel('Returns')\nax.set_title('S&P Equity Index: Nominal Returns, Real Returns, and Real GDP Growth')\nax.legend()\n\n# Show the chart\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](shiller-data-python_files/figure-html/cell-4-output-1.png){}\n:::\n:::\n\n\n\nThis code snippet creates a chart with a logarithmic scale, comparing nominal equity returns, real equity returns, and real GDP growth over time.\n\nConclusion\n\nThe resulting chart demonstrates the power of compounded returns and the equity risk premium that has rewarded long-term shareholders. By using Python libraries like requests, pandas, and Matplotlib, we can easily download, process, and visualize financial data to better understand market trends and investment strategies.\n\n\n",
    "supporting": [
      "shiller-data-python_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}