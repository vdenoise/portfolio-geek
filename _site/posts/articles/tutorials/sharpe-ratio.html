<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vincent D.">
<meta name="dcterms.date" content="2024-08-04">

<title>Portfolio Geek - Sharpe Ratio: A Must-Know for Every Investor</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CJ2CMCX5LZ"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-CJ2CMCX5LZ', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"headline",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Portfolio Geek - Sharpe Ratio: A Must-Know for Every Investor">
<meta property="og:description" content="Finance, Research and the Tech required to Fuel them">
<meta property="og:image" content="https://portfolio-geek.com/pictures/risk-return-concept.jpg">
<meta property="og:site_name" content="Portfolio Geek">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Portfolio Geek</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../daily-curation.html"> 
<span class="menu-text">Daily Findings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../tutorials.html"> 
<span class="menu-text">Getting Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../quotes_en.html"> 
<span class="menu-text">Quotes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../fr"> 
<span class="menu-text">Fran√ßais</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../"> 
<span class="menu-text">English</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/vdenoiseux/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vdenoise"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <h1 class="title">Sharpe Ratio: A Must-Know for Every Investor</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">coding</div>
                <div class="quarto-category">finance</div>
                <div class="quarto-category">risk</div>
                <div class="quarto-category">return</div>
                <div class="quarto-category">sharpe</div>
                <div class="quarto-category">ratio</div>
                <div class="quarto-category">python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Vincent D. </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 4, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">





<section id="sharpe-ratio-a-must-know-for-every-investor" class="level2">
<h2 class="anchored" data-anchor-id="sharpe-ratio-a-must-know-for-every-investor">Sharpe Ratio: A Must-Know for Every Investor</h2>
<div>

</div>
</section>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div id="first-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<section id="sharpe-ratio-a-must-know-for-every-investor-1" class="level2">
<h2 class="anchored" data-anchor-id="sharpe-ratio-a-must-know-for-every-investor-1">Sharpe Ratio: A Must-Know for Every Investor</h2>
<p>As a financial engineer with over 20 years of experience, I understand just how crucial the Sharpe Ratio is for evaluating investments. This essential metric provides a way to measure the risk-adjusted return of a portfolio, enabling smarter investment decisions. Let‚Äôs dive into the concept of the Sharpe Ratio and learn how to use Python to analyze and visualize it using real-world examples such as QQQ vs.&nbsp;SPY.</p>
</section>
</div>
<div id="second-column" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../pictures/risk-return-concept.jpg" class="img-fluid figure-img"></p>
<figcaption>Mitigating Risk and Return</figcaption>
</figure>
</div>
</div>
</div>
</div>
<section id="understanding-the-sharpe-ratio" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-sharpe-ratio">Understanding the Sharpe Ratio</h2>
<section id="what-is-the-sharpe-ratio" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-sharpe-ratio">What is the Sharpe Ratio?</h3>
<p>The Sharpe Ratio is a financial measure used to evaluate the return of an investment compared to its risk. The key formula behind this ratio is:</p>
<p><span class="math display">\[
Sharpe Ratio = \frac{R_p - R_f}{\sigma_p}
\]</span></p>
<p>Where:</p>
<ul>
<li>(R_p) is the expected return of the portfolio</li>
<li>(R_f) is the risk-free rate (such as Treasury yield)</li>
<li>(_p) represents the standard deviation of the portfolio‚Äôs excess return, symbolizing the risk</li>
</ul>
<p>By defining how much excess return you are achieving for every unit of risk, the Sharpe Ratio helps you make informed investment decisions.</p>
</section>
<section id="key-benefits-and-limitations" class="level3">
<h3 class="anchored" data-anchor-id="key-benefits-and-limitations">Key Benefits and Limitations</h3>
<p>One cannot ignore the advantages of using Sharpe Ratio:</p>
<ol type="1">
<li><strong>Assessing Performance</strong>: Easily compare different investments by their risk-adjusted returns.</li>
<li><strong>Identifying Efficient Portfolios</strong>: Helps in finding portfolios that offer higher returns for a certain risk level.</li>
<li><strong>Standardization</strong>: Offers a common measure across various asset classes.</li>
<li><strong>Risk Management</strong>: Encourages evaluating risk alongside returns.</li>
</ol>
<p>However, it‚Äôs not without limitations:</p>
<ol type="1">
<li><strong>Assumes Normal Distribution</strong>: Returns are assumed to be normally distributed, which is not always the case.</li>
<li><strong>Single Period Measure</strong>: Does not account for changing risk profiles over multiple periods.</li>
<li><strong>Sensitivity to Risk-Free Rate</strong>: Results can vary based on the risk-free rate used.</li>
<li><strong>Risk Measurement</strong>: Standard deviation might not reflect all types of risks.</li>
</ol>
</section>
<section id="how-to-calculate-the-sharpe-ratio" class="level3">
<h3 class="anchored" data-anchor-id="how-to-calculate-the-sharpe-ratio">How to Calculate the Sharpe Ratio</h3>
<p>The calculation steps for the Sharpe Ratio involve:</p>
<ol type="1">
<li>Gather historical return data over the desired period.</li>
<li>Determine the risk-free rate (government bonds or Treasury yields).</li>
<li>Compute the standard deviation of the investment‚Äôs excess returns.</li>
<li>Use the formula to calculate the Sharpe Ratio.</li>
</ol>
<p>Let‚Äôs move to some Python examples to see this in action.</p>
</section>
</section>
<section id="analising-qqq-vs.-spy-through-a-sharpe-ratio-lens" class="level2">
<h2 class="anchored" data-anchor-id="analising-qqq-vs.-spy-through-a-sharpe-ratio-lens">Analising QQQ vs.&nbsp;SPY through a Sharpe Ratio lens</h2>
<section id="historical-price-data-of-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="historical-price-data-of-qqq-and-spy">Historical Price Data of QQQ and SPY</h3>
<p>Understanding how QQQ (NASDAQ-100) and SPY (S&amp;P 500) performed over the last five years is always a good starting point. This visualization shows their performance trends and helps to lay the groundwork for further analysis.</p>
<div id="cell-6" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">%%</span>capture</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># Fetch historical price data for QQQ and SPY</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>tickers <span class="op">=</span> [<span class="st">"QQQ"</span>, <span class="st">"SPY"</span>]</span>
<span id="cb1-8"><a href="#cb1-8"></a>data <span class="op">=</span> yf.download(tickers, start<span class="op">=</span><span class="st">"2018-01-01"</span>, end<span class="op">=</span><span class="st">"2023-12-31"</span>)[<span class="st">'Adj Close'</span>]</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Plot the data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-7" class="cell" data-execution="{}" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>data.plot()</span>
<span id="cb2-3"><a href="#cb2-3"></a>plt.title(<span class="st">'Historical Price Data: QQQ vs. SPY'</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>plt.ylabel(<span class="st">'Adjusted Close Price'</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-3-output-1.png" width="659" height="282" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="annualized-returns-of-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="annualized-returns-of-qqq-and-spy">Annualized Returns of QQQ and SPY</h3>
<p>Now, let‚Äôs compare the annualized returns of QQQ and SPY over the same time period. This helps to evaluate the consistency and average performance of each fund on an annual basis.</p>
<div id="cell-9" class="cell" data-execution="{}" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Calculate annualized returns</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>annualized_returns <span class="op">=</span> (((data.iloc[<span class="op">-</span><span class="dv">1</span>] <span class="op">/</span> data.iloc[<span class="dv">0</span>]) <span class="op">**</span> (<span class="dv">1</span> <span class="op">/</span> <span class="dv">5</span>)) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># Plot the annualized returns</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>annualized_returns.plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>plt.title(<span class="st">'Annualized Returns: QQQ vs. SPY (in %)'</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a>plt.xlabel(<span class="st">'ETF'</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>plt.ylabel(<span class="st">'Annualized Return (in %)'</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-4-output-1.png" width="651" height="314" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="historical-volatility-of-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="historical-volatility-of-qqq-and-spy">Historical Volatility of QQQ and SPY</h3>
<p>To understand the risk associated with each ETF, we will plot their historical volatility. This is computed as the standard deviation of returns over the last five years, highlighting periods of higher volatility.</p>
<div id="cell-11" class="cell" data-execution="{}" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Calculate historical volatility</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>volatility <span class="op">=</span> data.pct_change().std() <span class="op">*</span> (<span class="dv">252</span> <span class="op">**</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="dv">100</span> <span class="co"># Annualized standard deviation</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Plot historical volatility</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>volatility.plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>plt.title(<span class="st">'Historical Volatility: QQQ vs. SPY  (in %)'</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>plt.xlabel(<span class="st">'ETF'</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>plt.ylabel(<span class="st">'Annualized Volatility (in %)'</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-5-output-1.png" width="651" height="314" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculating-excess-returns-of-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="calculating-excess-returns-of-qqq-and-spy">Calculating Excess Returns of QQQ and SPY</h3>
<p>To move towards the Sharpe Ratio, let‚Äôs calculate the excess returns of QQQ and SPY by subtracting the risk-free rate (say, 4% per annum for example) from their respective returns. This sets the stage for understanding how much return is gained relative to a risk-free investment.</p>
<div id="cell-13" class="cell" data-execution="{}" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>risk_free_rate <span class="op">=</span> <span class="fl">0.04</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># Calculate excess returns</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>excess_returns <span class="op">=</span> data.pct_change() <span class="op">-</span> risk_free_rate <span class="op">/</span> <span class="dv">252</span></span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Plot the excess returns</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a>excess_returns.plot()</span>
<span id="cb5-9"><a href="#cb5-9"></a>plt.title(<span class="st">'Excess Returns: QQQ vs. SPY'</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a>plt.ylabel(<span class="st">'Excess Return'</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-6-output-1.png" width="670" height="282" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sharpe-ratios-for-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="sharpe-ratios-for-qqq-and-spy">Sharpe Ratios for QQQ and SPY</h3>
<p>Now, let‚Äôs calculate and display the Sharpe Ratios for QQQ and SPY. This provides a visual representation of their risk-adjusted performance, giving immediate insight into which asset class, fund or ETF has delivered better returns relative to the risks taken.</p>
<div id="cell-15" class="cell" data-execution="{}" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Calculate Sharpe Ratios</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>sharpe_ratio <span class="op">=</span> excess_returns.mean() <span class="op">/</span> excess_returns.std() <span class="op">*</span> (<span class="dv">252</span> <span class="op">**</span> <span class="fl">0.5</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Plot the Sharpe Ratios</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a>sharpe_ratio.plot(kind<span class="op">=</span><span class="st">'bar'</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a>plt.title(<span class="st">'Sharpe Ratio: QQQ vs. SPY'</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a>plt.xlabel(<span class="st">'ETF'</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a>plt.ylabel(<span class="st">'Sharpe Ratio'</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-7-output-1.png" width="655" height="314" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rolling-sharpe-ratios-for-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="rolling-sharpe-ratios-for-qqq-and-spy">Rolling Sharpe Ratios for QQQ and SPY</h3>
<p>Observing the rolling Sharpe Ratios over a 12-month window provides enhanced insight into how risk-adjusted performance has changed over time under different market conditions.</p>
<div id="cell-17" class="cell" data-execution="{}" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Calculate rolling Sharpe Ratios</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>rolling_sharpe <span class="op">=</span> (excess_returns.rolling(window<span class="op">=</span><span class="dv">252</span>).mean() <span class="op">/</span> excess_returns.rolling(window<span class="op">=</span><span class="dv">252</span>).std()) <span class="op">*</span> (<span class="dv">252</span> <span class="op">**</span> <span class="fl">0.5</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co"># Plot rolling Sharpe Ratios</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>rolling_sharpe.plot()</span>
<span id="cb7-7"><a href="#cb7-7"></a>plt.title(<span class="st">'Rolling 12-Month Sharpe Ratio: QQQ vs. SPY'</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a>plt.ylabel(<span class="st">'Rolling Sharpe Ratio'</span>)</span>
<span id="cb7-10"><a href="#cb7-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-8-output-1.png" width="652" height="282" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparing-cumulative-sharpe-ratios-of-qqq-and-spy" class="level3">
<h3 class="anchored" data-anchor-id="comparing-cumulative-sharpe-ratios-of-qqq-and-spy">Comparing Cumulative Sharpe Ratios of QQQ and SPY</h3>
<p>Lastly, let‚Äôs compare the cumulative Sharpe Ratios of QQQ and SPY against a designated benchmark (e.g., a broader market index). This helps to gauge how well each ETF has outperformed relative to overall market trends.</p>
<div id="cell-19" class="cell" data-execution="{}" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Calculate cumulative Sharpe Ratios</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>cumulative_sharpe <span class="op">=</span> ((excess_returns.expanding(min_periods<span class="op">=</span><span class="dv">252</span>).mean()) <span class="op">/</span> excess_returns.expanding().std()) <span class="op">*</span> (<span class="dv">252</span> <span class="op">**</span> <span class="fl">0.5</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># Plot cumulative Sharpe Ratios</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>cumulative_sharpe.plot()</span>
<span id="cb8-7"><a href="#cb8-7"></a>plt.title(<span class="st">'Cumulative Sharpe Ratio: QQQ vs. SPY'</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>plt.xlabel(<span class="st">'Date'</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a>plt.ylabel(<span class="st">'Cumulative Sharpe Ratio'</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-9-output-1.png" width="670" height="282" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatter-plot-of-risk-vs.-return" class="level3">
<h3 class="anchored" data-anchor-id="scatter-plot-of-risk-vs.-return">Scatter Plot of Risk vs.&nbsp;Return</h3>
<p>Finally, we will create a scatter plot of risk versus return, plotting the expected returns of QQQ and SPY against their respective standard deviations. This visual representation underscores the efficient frontier concept, providing a comprehensive view of optimal risk-return trade-offs.</p>
<div id="cell-21" class="cell" data-execution="{}" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Calculate expected returns and standard deviations</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>expected_returns <span class="op">=</span> annualized_returns</span>
<span id="cb9-3"><a href="#cb9-3"></a>risk <span class="op">=</span> volatility</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Scatter plot of risk vs. return</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>plt.style.use(<span class="st">'getting_started-chart.mplstyle'</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a>plt.scatter(risk, expected_returns, label<span class="op">=</span>[<span class="st">'QQQ'</span>, <span class="st">'SPY'</span>])</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="cf">for</span> i, txt <span class="kw">in</span> <span class="bu">enumerate</span>(risk.index):</span>
<span id="cb9-9"><a href="#cb9-9"></a>    plt.annotate(txt, (risk[i], expected_returns[i]))</span>
<span id="cb9-10"><a href="#cb9-10"></a>plt.title(<span class="st">'Risk vs. Return: QQQ vs. SPY'</span>)</span>
<span id="cb9-11"><a href="#cb9-11"></a>plt.xlabel(<span class="st">'Annualized Volatility'</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>plt.ylabel(<span class="st">'Annualized Return'</span>)</span>
<span id="cb9-13"><a href="#cb9-13"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="sharpe-ratio_files/figure-html/cell-10-output-1.png" width="655" height="294" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>We have delved into the Sharpe Ratio, examined its merits and limitations, and visualized its application using real-world datasets of QQQ and SPY. This exploration highlights how investors can leverage this crucial metric for better risk-adjusted decision-making. While the Sharpe Ratio is invaluable, it‚Äôs essential to be aware of its limitations, such as the assumption of normally distributed returns and its sensitivity to the chosen risk-free rate.</p>
<p>For further reading, check out these insightful resources:</p>
<ul>
<li><a href="https://www.investopedia.com/terms/s/sharperatio.asp">Investopedia on Sharpe Ratio</a></li>
<li><a href="https://www.khanacademy.org/economics-finance-domain/core-finance/investment-vehicles-tutorial/capital-asset-pricing-model/v/sharpe-ratio">Khan Academy on CAPM and Sharpe Ratio</a></li>
</ul>
<p>Make sure to visit the Data Driven Minutes Youtube channel for a corresponding video on this topic. Happy investing!</p>
<p><a href="../../../about.html">About us and Disclaimers</a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/portfolio-geek\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Proudly propelled by <a href="https://quarto.org/">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>About | Copyright | Disclaimer</p>
</a>
  </li>  
</ul>
    <div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>